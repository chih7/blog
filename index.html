<!DOCTYPE html>
<html lang="zh">

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta content="black-translucent" name="apple-mobile-web-app-status-bar-style" />
    <meta content="telephone=no" name="format-detection" />
    <title>
    chih's blog    </title>
    <link rel="stylesheet" type="text/css" href="/theme/css/style.css" />
    <link rel="stylesheet" type="text/css" href="/theme/css/pygment.css" />
    <link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css" />
    <link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css" />
    <link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css" />
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico" />
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-117925025-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-117925025-1');
    </script>

</head>

<body>
<div class="body_container">
    <div id="header">
        <div class="site-name">
            <a id="logo" href="/."> chih's blog </a>
        </div>
        <div id="nav-menu">
            <a href="/."><i class="fa fa-home"> Home</i></a>
            <a href="/archives.html"><i class="fa fa-archive"> Archive</i></a>
            <a href="/pages/about-me.html"><i class="fa fa-user"> About</i></a>
        </div>
    </div>
    <div id="layout" class="pure-g">
        <div class="pure-u-1 pure-u-md-3-4"><div class="content_container">
<div class="post">
    <h1 class="post-title"><a href="/global-proxy-within-ipset-and-iptables.html">使用 iptables、ipset 的全局智能代理</a></h1>
    <div class="post-meta">2018-03-07</div>
    <a data-disqus-identifier="global-proxy-within-ipset-and-iptables.html" href="/global-proxy-within-ipset-and-iptables.html#disqus_thread" class="disqus-comment-count"></a>
    <div class="post-content">
        <p>首先，我这里的全局智能代理实现的功能主要有以下几点：</p>
<ol>
<li>基于iptables的全局代理，在Linux下可以实现只需设置一次，所有的软件(无论是GUI还是CLI)都可以免设置自动使用这个代理。</li>
<li>基于ipset，加入所有的国内IP项，对所有tcp流量进行判断，避免对国内的服务进行代理，一方面可以节省服务器流量，另一方面可以享受国内ip的优势，比如国内的版权视频、音乐，最后，避免被国内一些和政府有合作的IT企业发现你使用了代理。</li>
<li>iptables把需要代理的tcp流量交给shadowsocks-libev中的ss-redir，让它与代理服务器通讯。</li>
</ol>
<blockquote>
<p>让我们开始吧，在最开始，首先要说明的是：这份教程只适用于想要让你的Linux设备使用代理的用户，同时，下文的所有内容假设你运行的是Arch Linux。</p>
</blockquote>
<h2>设置 iptables</h2>
<p>首先，在<code>/etc/iptables</code>目录下创建一份新的规则：</p>
<div class="highlight"><pre><span></span><span class="c1"># Transparent SOCKS proxy</span>

<span class="o">*</span><span class="n">nat</span>
<span class="p">:</span><span class="n">PREROUTING</span> <span class="n">ACCEPT</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span>
<span class="p">:</span><span class="n">INPUT</span> <span class="n">ACCEPT</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span>
<span class="p">:</span><span class="n">OUTPUT</span> <span class="n">ACCEPT</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span>
<span class="p">:</span><span class="n">POSTROUTING …</span></pre></div>
    </div>
    <p class="readmore"><a href="/global-proxy-within-ipset-and-iptables.html">Read More</a></p>
</div>
<div class="post">
    <h1 class="post-title"><a href="/aiops.html">智能运维：从基于规则到基于学习</a></h1>
    <div class="post-meta">2018-03-01</div>
    <a data-disqus-identifier="aiops.html" href="/aiops.html#disqus_thread" class="disqus-comment-count"></a>
    <div class="post-content">
        <p>随着企业发展，其应用架构也越来越复杂，从单一的应用，到多个应用共同组合形成服务，到云计算、微服务架构，再到目前流行的容器化。除了基础的服务应用外，也出现了专门用于采集、存储与分析用户信息的大数据处理应用。云数据中心规模快速增长，运维环境的异构和复杂化，导致日常运维工作需要付出的人力、时间成本越来越高。运维的发展已经经历了脚本时代——工具时代——自动化时代(DevOps)，每一次的变迁都代表了运维需求的变化，运维技术的变革和运维人员效率的提高，随着大数据、机器学习和AI技术的飞速发展，运维需求也逐渐向智能化过渡。智能运维(AIOps)是自动化运维的拓展，其目的是进一步去除自动化运维中人为干扰，最终实现运维工作的无人化，完全自动化。</p>
<p>智能运维的内容主要有数据采集存储、异常自动检测、异常自动处理和数据的可视化。</p>
<h2>数据采集存储</h2>
<p>运维系统需要支持从机房设施、物理基础设施、数据中心网络、虚拟化资源池、云服务和应用到用户端日志的统一管理，实现多对象和多维度的集中监控。对于基础架构，需要采集的可能是性能数据，除了基础的CPU利用率、负载、%iowait，内存的利用率、页扫描、交换，磁盘的利用率、响应时间外，也可以使用处理器内包含的硬件计数器采集更详细的性能指标 …</p>
    </div>
    <p class="readmore"><a href="/aiops.html">Read More</a></p>
</div>
<div class="post">
    <h1 class="post-title"><a href="/Outlier-mining-review.html">离群点挖掘简述</a></h1>
    <div class="post-meta">2018-01-14</div>
    <a data-disqus-identifier="Outlier-mining-review.html" href="/Outlier-mining-review.html#disqus_thread" class="disqus-comment-count"></a>
    <div class="post-content">
        <h2>引言</h2>
<p>离群点是一个或一组明显不同于其他数据的数据点。Hawkins把离群点定义为“离群点是在数据集中偏离大部分数据的数据，使人怀疑这些数据的偏离并非由随机因素产生，而是产生于完全不同的机制。”</p>
<p>在大多数应用中，数据由一到多个程序产生，这些数据可以反映出系统的运行状态和被监测客体的相关数值。当测量、输入错误或系统运行错误时，或者客体出现异常行为，离群点就会产生。因此，离群点经常包含关于系统与实体异常特征的有效信息。现有数据挖掘研究大多集中于发现适用于大部分数据的常规模式,在许多应用领域中，离群点通常作为噪音而忽略，许多数据挖掘算法试图降低或消除离群点的影响。而在有些应用领域识别离群点是许多工作的基础和前提，离群点会带给我们新的视角。如在欺诈检测中，离群点可能意味欺诈行为的发生，在入侵检测中离群点可能意味入侵行为的发生。其他的一些应用场景包括信用卡诈骗、医疗诊断、执法、地球科学……</p>
<p>离群点的检测算法输出可以是两种类型之一：</p>
<ol>
<li>大多数离群点检测算法，输出一个关于数据点的“离群性”得分。这个得分可以用于分析数据点的离群趋势。</li>
<li>第二种类型的输出是表示一个数据点是否离群的二进制标签。一些算法可能直接返回二进制标签，但离群得分也可转换成二进制标签。</li>
</ol>
<p>早期对离群点研究的主要目的是消除离群点，那时离群点一般被视为“噪音”，但随着离群点分析的流行，发现“噪声”中存在有趣的数据。在真实的应用中，数据可能嵌入了大量的噪音，但大部分噪音对于分析是无趣的。</p>
<p>如下图所示，在(a …</p>
    </div>
    <p class="readmore"><a href="/Outlier-mining-review.html">Read More</a></p>
</div>
<div class="post">
    <h1 class="post-title"><a href="/simjoin-on-spark.html">基于SPARK的分布式网页近似度检测</a></h1>
    <div class="post-meta">2017-07-09</div>
    <a data-disqus-identifier="simjoin-on-spark.html" href="/simjoin-on-spark.html#disqus_thread" class="disqus-comment-count"></a>
    <div class="post-content">
        <h2>前言</h2>
<p>随着Web上数量的急剧增长，近似镜像网页的数量也在不断增加。近似镜像网页的存在，严重影响了搜索引擎的检索结果。如果我们能将搜集到的网页中的近似镜像网页去掉，可以提高搜集系统和索引系统效率，用户查询时也不会出现大量内容重复的网页。去除镜像网页即需要网页近似度检测算法。实验基于相似性连接实现了基于SPARK的分布式网页近似度检测，对5000个网页进行了相似度检测，试图找出所有相似的网页。实验使用的网页来源与人才招聘网站的电子简历，共有5000份，由于我们只关心其中的简历内容，因此需要去除简历内容外的HTML标签，网页样式、代码。在去除了无关内容后，即可进行近似检测，大数据环境下，数据量巨大，运用传统的方式进行相似性连接效率极低，实验选择了相似性连接查询作为底层的算法实现，作为一种分布式算法，实验选择了Spark作为分布式计算框架。</p>
<p>相似性连接查询，即查找相似的数据对象对，具有广泛的应用领域，例如相似网页检、实体解析、数据清洗和相似图像检索等。 在相似网页检测中，使用相似性连接等技术识别相似的网页，不但可以帮助网页搜索引擎执行聚焦爬行，提高搜索结果的质量和多样性，还可以识别垃圾邮件。在实体解析中，使用相似性连接技术，可以找到企业数据库里相似的顾客，匹配产品报价等。在数据清洗中，使用相似性连接技术，可以为不同数 据源集成提供一致、准确的数据。在相似图像检索 中，使用相似性连接技术检索出相似的图像，可以分析图像的来源 …</p>
    </div>
    <p class="readmore"><a href="/simjoin-on-spark.html">Read More</a></p>
</div>
<div class="post">
    <h1 class="post-title"><a href="/vldb-downloader.html">抓取网页中所有PDF链接并下载的Python脚本</a></h1>
    <div class="post-meta">2017-07-05</div>
    <a data-disqus-identifier="vldb-downloader.html" href="/vldb-downloader.html#disqus_thread" class="disqus-comment-count"></a>
    <div class="post-content">
        <h2>说点什么</h2>
<p>没什么好说的，工具脚本，代码都在下面，可能改一下后可以适用于其他地方。</p>
<h2>代码</h2>
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Thu Jul  6 11:04:53 2017</span>

<span class="sd">@author: chih</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s1">&#39;http://www.vldb.org/pvldb/vol10.html&#39;</span>

<span class="k">class</span> <span class="nc">VldbCrawler</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_url</span><span class="o">=</span><span class="n">BASE_URL</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="n">base_url</span>

    <span class="k">def</span> <span class="nf">fetch_download_link</span><span class="p">(</span><span class="bp">self …</span></pre></div>
    </div>
    <p class="readmore"><a href="/vldb-downloader.html">Read More</a></p>
</div>
<div class="post">
    <h1 class="post-title"><a href="/spark-sql-ppt.html">Spark SQL 笔记</a></h1>
    <div class="post-meta">2017-06-25</div>
    <a data-disqus-identifier="spark-sql-ppt.html" href="/spark-sql-ppt.html#disqus_thread" class="disqus-comment-count"></a>
    <div class="post-content">
        <h2>Spark SQL Overview</h2>
<p>特性：</p>
<ul>
<li>Spark SQL是Apache Spark中的一个新模块</li>
<li>将关系处理（tables with rows/columns）与Spark的功能编程API相集成</li>
<li>通过 SQL 操作 RDDs， 同时提供多种语言绑定</li>
<li>数据源集成：Hive, Parquet, JSON,and more</li>
<li>提供 JDBC/ODBC 接口供外部程序调用（商业智能、olap分析）</li>
</ul>
<p>目标：</p>
<ul>
<li>写更少的代码</li>
<li>读更少的数据</li>
<li>获得更高的性能</li>
</ul>
<hr>
<h2>Spark SQL in Spark</h2>
<p><img alt="Screenshot_20170522_193655" src="images/Screenshot_20170522_193655.png" width="80%"></p>
<ul>
<li>Spark SQL was first released in Spark 1.0 (May, 2014)</li>
</ul>
<hr>
<h2>Relationship …</h2>
    </div>
    <p class="readmore"><a href="/spark-sql-ppt.html">Read More</a></p>
</div>
<div class="post">
    <h1 class="post-title"><a href="/spark-sql.html">Spark SQL</a></h1>
    <div class="post-meta">2017-06-24</div>
    <a data-disqus-identifier="spark-sql.html" href="/spark-sql.html#disqus_thread" class="disqus-comment-count"></a>
    <div class="post-content">
        <h2>Spark 简介</h2>
<p>Hadoop 伴随着大数据的兴起已有十年时间，被认为是大数据处理的首选解决方案， 它分别提供HDFS和MapReduce解决了大数据（无法在单台机器上存储与处理的数据）的可靠存储和处理，但对于一些场景， MapReduce并不是十分高效，其一，MapReduce的抽象层次低，仅提供了map和reduce两个操作，对于应用需要编写大量代码；其二，一个job只包括了map和reduce两个阶段，想要完成复杂的工作，就必须串联一系列MapReduce作业，但每一步的输出数据必须存储到HDFS，导致io操作繁重，时延较高，只适合批处理，不适合实时处理和迭代计算。</p>
<p>Apache Spark是一个新兴的大数据处理引擎，它允许开发者使用有向无环图 (DAG) 开发复杂的数据操作，内部使用一个集群上的分布式内存抽象 (RDD) ，简化了对分布式数据的编程复杂性。RDD 提供了两类操作，转换和动作，转换在原有 RDD 上通过一些操作定义了一个新的 RDD ，包括map, flatMap, filter, union, sample, join, groupByKey, cogroup, ReduceByKey, cros, sortByKey, mapValues等 …</p>
    </div>
    <p class="readmore"><a href="/spark-sql.html">Read More</a></p>
</div>

<div class="page-navigator">
    <span class="page-number current">1</span>
    <a class="page-number" href="/index2.html">2</a>
    <a class="page-number" href="/index3.html">3</a>
    <a class="page-number" href="/index4.html">4</a>
    <a class="extend next" rel="next" href="/index2.html">Next</a></nav>
</div class="page-navigator">

    <script id="dsq-count-scr" src="//chihsblog.disqus.com/count.js" async></script>

        </div></div>
        <div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar">
<div class="widget">
    <form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form">
        <input type="text" name="q" maxlength="20" placeholder="Search"/>
        <input type="hidden" name="sitesearch" value="https://blog.chih.me"/>
    </form>
</div><div class="widget">
    <div class="widget-title">
        <i class="fa fa-folder-o"> Categories</i>
    </div>
    <ul class="category-list">
        <li class="category-list-item"><a class="category-list-link" href="/category/misc.html">misc</a></li>
        <li class="category-list-item"><a class="category-list-link" href="/category/self.html">Self</a></li>
        <li class="category-list-item"><a class="category-list-link" href="/category/tech.html">Tech</a></li>
    </ul>
</div><div class="widget">
    <div class="widget-title"><i class="fa fa-star-o"> Tags</i></div>
    <div class="tagcloud">
    <a href="/tag/shi-shi-ji-suan.html" style="font-size: 10px">实时计算</a>
    <a href="/tag/dai-li.html" style="font-size: 10px">代理</a>
    <a href="/tag/storm.html" style="font-size: 10px">Storm</a>
    <a href="/tag/big-data.html" style="font-size: 12px">big data</a>
    <a href="/tag/da-shu-ju.html" style="font-size: 12px">大数据</a>
    <a href="/tag/hadoop.html" style="font-size: 10px">hadoop</a>
    <a href="/tag/shadowsocks.html" style="font-size: 10px">shadowsocks</a>
    <a href="/tag/linux.html" style="font-size: 16px">Linux</a>
    <a href="/tag/spark.html" style="font-size: 12px">Spark</a>
    <a href="/tag/sql.html" style="font-size: 10px">SQL</a>
    </div>
</div><div class="widget">
    <div class="widget-title"><i class="fa fa-file-o"> Recent</i></div>
    <ul class="post-list">
        <li class="post-list-item">
        <a class="post-list-link" href="/global-proxy-within-ipset-and-iptables.html">使用 iptables、ipset 的全局智能代理</a>
        </li>
        <li class="post-list-item">
        <a class="post-list-link" href="/aiops.html">智能运维：从基于规则到基于学习</a>
        </li>
        <li class="post-list-item">
        <a class="post-list-link" href="/Outlier-mining-review.html">离群点挖掘简述</a>
        </li>
        <li class="post-list-item">
        <a class="post-list-link" href="/simjoin-on-spark.html">基于SPARK的分布式网页近似度检测</a>
        </li>
        <li class="post-list-item">
        <a class="post-list-link" href="/vldb-downloader.html">抓取网页中所有PDF链接并下载的Python脚本</a>
        </li>
        <li class="post-list-item">
        <a class="post-list-link" href="/spark-sql-ppt.html">Spark SQL 笔记</a>
        </li>
        <li class="post-list-item">
        <a class="post-list-link" href="/spark-sql.html">Spark SQL</a>
        </li>
        <li class="post-list-item">
        <a class="post-list-link" href="/shark-ppt.html">Shark</a>
        </li>
        <li class="post-list-item">
        <a class="post-list-link" href="/read-cpu-power-with-RAPL.html">Energy measurements in Linux</a>
        </li>
        <li class="post-list-item">
        <a class="post-list-link" href="/power-with-different-cpufreq.html">Ubuntu 16.04 下 CPU 频率与功耗关系</a>
        </li>
    </ul>
</div><div class="widget">
    <div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div>
    <script type="text/javascript" src="//chihsblog.disqus.com/recent_comments_widget.js?num_items=5&hide_avatars=1&avatar_size=32&excerpt_length=20&hide_mods=1"></script>
</div>
<div class="widget">
    <div class="widget-title"><i class="fa fa-external-link"> Blogroll</i></div>
    <ul></ul>
    <a href="http://www.hjk.im/" title="HJK" target="_blank">HJK</a>
    <ul></ul>
    <a href="http://imis.me/" title="记忆反射弧" target="_blank">记忆反射弧</a>
    <ul></ul>
    <a href="http://mijack.github.io/" title="mijack" target="_blank">mijack</a>
    <ul></ul>
    <a href="http://datahcong.cn/" title="whl的博客园" target="_blank">whl的博客园</a>
</div>
        </div></div>
        <div class="pure-u-1 pure-u-md-3-4">
<div id="footer">Copyright © 2018 <a href="/." rel="nofollow">chih's blog.</a> Powered by <a rel="nofollow" target="_blank" href="https://getpelican.com/">Pelican</a> and <a rel="nofollow", target="_blank", href="https://github.com/wormtooth/maupassant-pelican">maupassant</a>.</div>        </div>
    </div>
</div>

<a id="rocket" href="#top" class="show"></a>
<script type="text/javascript" src="/theme/js/totop.js" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script>
<script type="text/javascript" src="/theme/js/fancybox.js" async></script>
<link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css" />

</body>
</html>